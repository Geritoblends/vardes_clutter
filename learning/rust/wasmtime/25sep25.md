# Plugin system using wasmtime::Caller


### Part I. Methods

#### 1. Define the Host Data struct
```rust
use wasmtime::Func;

struct HostData {
    methods: HashMap<String, Func>, // String should be changed to a fixed-length variable
    listeners: HashMap<String, Vec<Func>> // Same thing
}
```

#### 2. Get some module's Func exports

```rust
for export in instance.exports(&mut store) {
    if let Some(func) = export.into_func() {
        let name = export.name().to_string();
        &self.methods.insert(name, func);
    }
}
```

#### 3. Create a Host function that will be imported to all the Modules

`wasmtime::Caller` allows us to have both, the Calling (the Module that calls the function) and Host state from the Module's perspective:

```rust
// Val::V128 should be able to model anything with ptr: i64, len: i64
fn host_call_function(mut caller: Caller<'_, HostData>, function_id: [u8; 12], args: Val) -> Val {
    todo!();
}
```
